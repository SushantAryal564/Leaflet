<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Leaflet Tutorial</title>
    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.9.2/dist/leaflet.css"
      integrity="sha256-sA+zWATbFveLLNqWO2gtiw3HL/lh1giY/Inf1BJ0z14="
      crossorigin=""
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
      crossorigin="anonymous"
    />
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://unpkg.com/leaflet@1.9.2/dist/leaflet.js"
      integrity="sha256-o9N1jGDZrf5tS+Ft4gbIK7mYMipq9lqpVJ91xHSyKhg="
      crossorigin=""
    ></script>

    <style>
      #mapdiv {
        height: 100vh;
      }
    </style>
  </head>
  <body>
    <div id="side-bar" class="col-md-3"></div>
    <div id="mapdiv" class="col-md-9"></div>
    <script>
      var mymap;
      var lyresri;
      var mrkCurrentLocation;
      mymap = L.map("mapdiv", {
        center: [19.4, -99.2],
        zoom: 5,
        zoomControl: true,
        zoomDelta: 1,
        dragging: false,
        minZoom: 5,
        maxZoom: 17,
        attributionControl: false,
        trackResize: true,
        boxZoom: true,
        doubleClickZoom: true,
      });
      lyresri = L.tileLayer(
        "https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",
        {
          attribution:
            "Tiles &copy; Esri &mdash; Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community",
        }
      );
      mymap.addLayer(lyresri);
      setInterval(function () {
        mymap.locate();
      }, 5000);
      mymap.on("click", function (e) {
        console.log(e);
        if (e.originalEvent.shiftKey) {
          alert(mymap.getZoom());
        } else {
          alert(e.latlng.toString());
        }
      });
      mymap.on("contextmenu", function (e) {
        let dtCurrentTime = new Date();
        L.marker(e.latlng)
          .addTo(mymap)
          .bindPopup(e.latlng.toString() + "<br>" + dtCurrentTime.toString());
      });
      mymap.on("keypress", function (e) {
        console.log(e);
        if (e.originalEvent.key == "l") {
          mymap.locate();
        }
      });
      mymap.on("locationfound", function (e) {
        console.log(e);
        if (mrkCurrentLocation) {
          mrkCurrentLocation.remove();
        }
        mrkCurrentLocation = L.circle(e.latlng, {
          radius: e.accuracy / 2,
        }).addTo(mymap);
        mymap.setView(e.latlng, 14);
      });
      mymap.on("locationerror", function (e) {
        console.log(e);
        alert("Location wasn't found");
      });
    </script>
  </body>
</html>
